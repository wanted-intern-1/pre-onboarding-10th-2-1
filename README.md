![image](https://user-images.githubusercontent.com/66008508/236441351-7053b345-d5a7-4040-858a-52990b4b97a3.png)

# ì›í‹°ë“œ í”„ë¦¬ì˜¨ë³´ë”© í”„ë¡ íŠ¸ì—”ë“œ - 1íŒ€

íœ´ë¨¼ ìŠ¤ì¼€ì´í”„ ê¸°ì—… ê³¼ì œ ìˆ˜í–‰

#### [ê³¼ì œ ëª©í‘œ](#ğŸ“œê³¼ì œ-ëª©í‘œ)

[í•œêµ­ ì„ìƒì •ë³´ ì‚¬ì´íŠ¸](https://clinicaltrialskorea.com/)ì˜ ê²€ìƒ‰ ì˜ì—­ í´ë¡  ì½”ë”©

---

#### ë°°í¬ë§í¬ : https://main--pre-onboarding-2-1.netlify.app/

#### íŒ€ ë…¸ì…˜ : [page link](https://iamdooddi.notion.site/T1-8d53ec6136ce454e95de6cd5c0e0ed9b)

#### í˜‘ì—… ë°©ì‹ : [page link](https://iamdooddi.notion.site/d4d24d73a2e9441597ca69da749fd8a1)

## íŒ€ ì†Œê°œ

| ì´ë¦„          | github                          |
| ------------- | ------------------------------- |
| ì—„ì„±í˜„ (íŒ€ì¥) | https://github.com/eomsteve     |
| ì „í•˜ì¤€        | https://github.com/Majesty-jun  |
| ì°¨ë™ì—½        | https://github.com/dongyeopca   |
| ë…¸ì§€ì›        | https://github.com/no-support   |
| ì†ìœ ì •        | https://github.com/yuj1818      |
| ê¹€ë‹¤í˜„        | https://github.com/Plu457       |
| ì •ìŠ¹ë•        | https://github.com/seungdeok    |
| ìµœìŠ¹ì£¼        | https://github.com/VictoryJu    |
| ë°•ìš°í˜„        | https://github.com/woohyun-park |
| ê°ˆë¯¸í˜„        | https://github.com/Kal-MH       |

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
ğŸ“¦src
 â”£ ğŸ“‚api
 â”ƒ â”£ ğŸ“œapi.ts
 â”ƒ â”£ ğŸ“œkeyword.ts
 â”ƒ â”— ğŸ“œlocalStorage.ts
 â”£ ğŸ“‚assets
 â”ƒ â”£ ğŸ“œIllustPersonOne.tsx
 â”ƒ â”£ ğŸ“œIllustPersonThree.tsx
 â”ƒ â”£ ğŸ“œIllustPersonTwo.tsx
 â”ƒ â”— ğŸ“œindex.ts
 â”£ ğŸ“‚components
 â”ƒ â”£ ğŸ“‚common
 â”ƒ â”ƒ â”£ ğŸ“œCMContainer.tsx
 â”ƒ â”ƒ â”— ğŸ“œCMNoticeLIne.tsx
 â”ƒ â”£ ğŸ“‚keyword
 â”ƒ â”ƒ â”£ ğŸ“œKeywordInput.tsx
 â”ƒ â”ƒ â”£ ğŸ“œKeywordList.tsx
 â”ƒ â”ƒ â”£ ğŸ“œKeywordMain.tsx
 â”ƒ â”ƒ â”— ğŸ“œKeywordRecent.tsx
 â”ƒ â”— ğŸ“‚main
 â”ƒ â”ƒ â”£ ğŸ“œBackground.tsx
 â”ƒ â”ƒ â”— ğŸ“œMain.tsx
 â”£ ğŸ“‚hooks
 â”ƒ â”£ ğŸ“œuseDebounce.ts
 â”ƒ â”£ ğŸ“œuseForwardRef.ts
 â”ƒ â”— ğŸ“œuseOutsideClick.ts
 â”£ ğŸ“‚pages
 â”ƒ â”— ğŸ“‚main
 â”ƒ â”ƒ â”— ğŸ“œMainPage.tsx
 â”£ ğŸ“‚routes
 â”ƒ â”— ğŸ“œRouter.tsx
 â”£ ğŸ“‚styles
 â”ƒ â”— ğŸ“œglobal.ts
 â”£ ğŸ“‚types
 â”ƒ â”— ğŸ“œkeyword.ts
 â”£ ğŸ“‚utils
 â”ƒ â”£ ğŸ“‚const
 â”ƒ â”ƒ â”£ ğŸ“œkeyboard.ts
 â”ƒ â”ƒ â”— ğŸ“œkeyword.ts
 â”ƒ â”£ ğŸ“œdebounce.ts
 â”ƒ â”£ ğŸ“œhandleSliceData.ts
 â”ƒ â”£ ğŸ“œhighlight.ts
 â”ƒ â”— ğŸ“œisExpired.ts
 â”£ ğŸ“œApp.tsx
 â”£ ğŸ“œindex.css
 â”£ ğŸ“œindex.tsx
```

---

#### localì‹¤í–‰ì‹œ

```shell
npm install && npm run start
```

# ğŸ“œê³¼ì œ ëª©í‘œ

- [ê²€ìƒ‰ì°½ êµ¬í˜„](##ğŸ”ê²€ìƒ‰ì°½)
- [ê²€ìƒ‰ì–´ ì¶”ì²œ ê¸°ëŠ¥ êµ¬í˜„](##ğŸ”ê²€ìƒ‰ì–´-ì¶”ì²œ-ê¸°ëŠ¥)
- [ìºì‹± ê¸°ëŠ¥ êµ¬í˜„](##ğŸ’½ìºì‹±)

## ğŸ”ê²€ìƒ‰ì°½

ì„ìƒ ì‹œí—˜ì„ ê²€ìƒ‰í•˜ëŠ” ê²€ìƒ‰ì°½ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.
ê²€ìƒ‰ì°½ì„ í´ë¦­í–ˆì„ ê²½ìš° outline ringìœ¼ë¡œ focus í•´ì£¼ê³ , ì¶”ì²œê²€ìƒ‰ì–´ì™€ ìµœê·¼ê²€ìƒ‰ì–´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì…ë ¥ì°½ì— ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•  ê²½ìš° ê²€ìƒ‰ì–´ì— ë”°ë¥¸ ì¶”ì²œ ê²€ìƒ‰ì–´ ë¦¬ìŠ¤íŠ¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![ë…¹í™”_2023_05_05_20_09_50_259](https://user-images.githubusercontent.com/66008508/236443228-d1e152c2-a968-4091-ab07-ecda1e303048.gif)

### ê²€ìƒ‰ì°½ í´ë¦­

- ê²€ìƒ‰ì°½ í´ë¦­ì‹œ focus ringí™œì„±í™”
- ì¶”ì²œê²€ìƒ‰ì–´, ìµœê·¼ê²€ìƒ‰ì–´ ì°½ í™œì„±í™”

![image](https://user-images.githubusercontent.com/66008508/236441582-ed7a0630-8ec7-4dbe-beb8-4932e17913ae.png)

### ê²€ìƒ‰ì°½ ë°”ê¹¥ í´ë¦­

- ê²€ìƒ‰ì°½ì—ì„œ ë²—ì–´ë‚¬ìœ¼ë¯€ë¡œ focus ring ë¹„í™œì„±í™”
- ì¶”ì²œ ê²€ìƒ‰ì–´ ì°½ ë¹„í™œì„±í™”

```ts
import { useEffect, RefObject } from 'react';

const useOutsideClick = (ref: RefObject<any>, callback: Function) => {
  useEffect(() => {
    const handleClickOutside = (e: any) => {
      if (ref.current && !ref.current.contains(e.target)) {
        callback();
      }
    };
    document.addEventListener('mousedown', handleClickOutside);
    return () => {
      document.removeEventListener('mousedown', handleClickOutside);
    };
  });
};

export default useOutsideClick;
```

### [ìµœê·¼ ê²€ìƒ‰ì–´](https://github.com/wanted-intern-1/pre-onboarding-10th-2-1/blob/main/src/api/localStorage.ts)

ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ìµœê·¼ì— ê²€ìƒ‰í–ˆë˜ ê¸°ë¡ì„ ì €ì¥í•˜ì—¬ ê²€ìƒ‰ì°½ì„ ì´ìš©í• ë•Œ ê°€ì¥ ì²˜ìŒìœ¼ë¡œ ë‚˜íƒ€ë‚ ìˆ˜ ìˆê²Œ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

```ts
...
export const getRecentKeywords = () => {
  return JSON.parse(localStorage.getItem(CSKeyword.RECENT_KEY) || '[]');
};

export const addRecentKeyword = (recent: string) => {
  const recents = getRecentKeywords();
  const jsonRecents = JSON.stringify(
    handleSliceData([recent, ...recents.filter((e: string) => e !== recent)])
  );
  localStorage.setItem(CSKeyword.RECENT_KEY, jsonRecents);
};
```

### í‚¤ë³´ë“œë§Œìœ¼ë¡œ ì¶”ì²œ ê²€ìƒ‰ì–´ë“¤ë¡œ ì´ë™

#### [í‚¤ë³´ë“œ ë™ì‘](https://github.com/wanted-intern-1/pre-onboarding-10th-2-1/blob/main/src/components/keyword/KeywordInput.tsx)

- í‚¤ë³´ë“œ UP/DOWNì„ ì‚¬ìš©í•˜ì—¬ ìµœê·¼/ì¶”ì²œ ê²€ìƒ‰ì–´ ì„ íƒ
- ë‹ë³´ê¸°ë¥¼ ëˆŒëŸ¬ ê²€ìƒ‰ (ì„ íƒëœ ê²€ìƒ‰ì–´ë¥¼ ìµœê·¼ ê²€ìƒ‰ì–´ì— ì¶”ê°€)
- ì„ íƒëœ ê²€ìƒ‰ì–´ê°€ ìˆë‹¤ë©´, ì—”í„°ë¥¼ ëˆŒëŸ¬ ê²€ìƒ‰
- ì„ íƒëœ ê²€ìƒ‰ì–´ê°€ ì—†ê³  keyword(ì‚¬ìš©ì ì…ë ¥ê°’)ê°€ ì¡´ì¬í•˜ë©´ ì—”í„°ë¥¼ ëˆŒëŸ¬ ê²€ìƒ‰
- ê²€ìƒ‰ì‹œ keywordë¥¼ ì•Œë§ê²Œ ë³€ê²½

  | e.g. keywordëŠ” ""ì¸ ìƒíƒœì´ê³ , ìµœê·¼ ê²€ìƒ‰ì–´ ì¤‘ "ë¹„ë§Œ"ì„ ì„ íƒ í›„ ê²€ìƒ‰í•˜ì˜€ë‹¤ë©´ keywordë¥¼ "ë¹„ë§Œ"ìœ¼ë¡œ ë³€ê²½

```typescript
const handleSearchKeyword = () => {
  handleEnterPress(keyword, getRecentKeywords());
};

const handleEnterPress = (keyword: string, recents: string[]) => {
  refLocal.current.blur();
  setIsClick(false);
  setSelectIndex(-1);
  let recent;
  // ì—”í„°í‚¤ ì…ë ¥ì‹œ, ì„ íƒëœ ê²€ìƒ‰ì–´ê°€ ìˆë‹¤ë©´ ê²€ìƒ‰
  if (keyword) {
    handleSearch(keyword);
    recent = selectIndex === -1 || selectIndex === 0 ? keyword : keywords[selectIndex - 1].name;
  } else {
    if (selectIndex === -1) return;
    recent = recents[selectIndex - 1];
  }
  addRecentKeyword(recent);
  setKeyword(recent);
};

const moveRecentUp = (recents: string[]) => {
  setSelectIndex((prev) => (prev <= 1 ? recents.length : prev - 1));
};

const moveKeywordUp = (keywords: IKeyword[]) => {
  setSelectIndex((prev) => (prev <= 0 ? keywords.length : prev - 1));
};

const moveRecentDown = (recents: string[]) => {
  setSelectIndex((prev) => (selectIndex === -1 ? 1 : prev >= recents.length ? 1 : prev + 1));
};

const moveKeywordDown = (keywords: IKeyword[]) => {
  setSelectIndex((prev) => (prev >= keywords.length - 1 ? 0 : prev + 1));
};

const handleKeyPress = (e: React.KeyboardEvent) => {
  if (e.nativeEvent.isComposing) return;
  // ìµœê·¼ê²€ìƒ‰ì–´ê°€ ìˆë‹¤ë©´ í‚¤ë³´ë“œ ì´ë²¤íŠ¸ë¥¼ í†µí•´ì„œ ì´ë™ê°€ëŠ¥
  const recents = JSON.parse(localStorage.getItem(CSKeyword.RECENT_KEY) || '[]');
  const moveUp = keyword ? moveKeywordUp : moveRecentUp;
  const moveDown = keyword ? moveKeywordDown : moveRecentDown;

  switch (e.key) {
    case keyboards.ESCAPE:
      setKeyword('');
      break;
    case keyboards.ENTER:
      handleEnterPress(keyword, recents);
      break;
    case keyboards.DOWN:
      e.preventDefault();
      moveDown(keyword ? keywords : recents);
      break;
    case keyboards.UP:
      e.preventDefault();
      moveUp(keyword ? keywords : recents);
      break;
    default:
      break;
  }
};
```

### ê²€ìƒ‰ì°½ ì…ë ¥

ì…ë ¥ë§ˆë‹¤ API í˜¸ì¶œí•˜ì§€ ì•Šë„ë¡ API **í˜¸ì¶œ íšŸìˆ˜ë¥¼ ì¤„ì´ëŠ” ì „ëµ** ìˆ˜ë¦½

### [useDebounce](https://github.com/wanted-intern-1/pre-onboarding-10th-2-1/blob/main/src/hooks/useDebounce.ts)

inputì˜ `onChange`ì´ë²¤íŠ¸ê°€ í˜¸ì¶œë ë•Œ ì‚¬ìš©ìì˜ ì…ë ¥ì„ ê°ì§€í•˜ê³  200ms ì´ë‚´ì— ì¶”ê°€ ì…ë ¥ì´ ì—†ë‹¤ë©´ ì…ë ¥ì´ ëë‚œê²ƒìœ¼ë¡œ íŒë‹¨, ì…ë ¥ì´ ëë‚¬ì„ë•Œë§Œ APIí˜¸ì¶œ ì „ëµì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.

```typescript
import { useState, useEffect } from 'react';

export function useDebounce(value: string) {
  const [debouncedValue, setDebouncedValue] = useState<string>(value);

  useEffect(() => {
    const timer = setTimeout(() => {
      setDebouncedValue(value);
    }, 200);

    return () => {
      clearTimeout(timer);
    };
  }, [value]);

  return debouncedValue;
}
```

### ê²€ìƒ‰ëœ ë¬¸ì ê°•ì¡°

ê²€ìƒ‰ì°½ì— ê²€ìƒ‰ì–´ ì…ë ¥ì‹œ, ì¶”ì²œ í‚¤ì›Œë“œì— ì…ë ¥í•œê²€ìƒ‰ì–´ê°€ í•˜ì´ë¼ì´íŠ¸ ë˜ë„ë¡ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

```ts
export const highlight = (name: string, keyword: string) => {
  if (!name) return '';
  const index = name.toLowerCase().indexOf(keyword.toLowerCase());
  if (index !== -1) {
    return name.replace(new RegExp(`(${keyword})`, 'giu'), '<strong>$1</strong>');
  }
  return name;
};
```

## ğŸ”ê²€ìƒ‰ì–´ ì¶”ì²œ ê¸°ëŠ¥

ê²€ìƒ‰ì°½ì— ì…ë ¥ëœ ê°’ì„ í†µí•´ APIë¥¼ í˜¸ì¶œí•˜ì—¬ ì¶”ì²œ ê²€ìƒ‰ì–´ ë¦¬ìŠ¤íŠ¸ë¥¼ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![ë…¹í™”_2023_05_05_20_22_33_587](https://user-images.githubusercontent.com/66008508/236445121-96446072-3682-4d2a-b4de-0ef23f2d503f.gif)

- APIë¥¼ í˜¸ì¶œí•  ë•Œ ë§ˆë‹¤ console.info("calling api") ì¶œë ¥ì„ í†µí•´ ì½˜ì†”ì°½ì—ì„œ API í˜¸ì¶œ íšŸìˆ˜ í™•ì¸
- ìºì‹±ëœ ê°’ì„ ì´ìš©í•´ APIë¥¼ ë§¤ë²ˆ í˜¸ì¶œí•˜ì§€ ì•Šê³ , í•œë²ˆ í˜¸ì¶œ ë˜ì—ˆë˜ APIì¼ ê²½ìš° ìºì‹±ëœ ê°’ ì´ìš©

### ê²€ìƒ‰ì–´ ê²°ê³¼ê°’ ê¸¸ì´ ì œí•œ

ê²€ìƒ‰ ê²°ê³¼ê°€ ë§ì„ê²½ìš° ê²°ê³¼ê°’ ìƒìœ„5ê°œì˜ ê²°ê³¼ê°’ë§Œ ë…¸ì¶œí–ˆìŠµë‹ˆë‹¤.

```ts
export const handleSliceData = (data: [] | any) => {
  return data.slice(0, CSKeyword.MAX_LEN);
};
```

## ğŸ’½ìºì‹±

web APIì˜ CachingStorageë¥¼ í™œìš©í•˜ì—¬ urlìš”ì²­ì— ëŒ€í•œ ìºì‹œê°’ì„ ì €ì¥í•˜ê¸° ìœ„í•´ fetchAPIë¥¼ ì´ìš©í•´ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. ì´ë¯¸ ì…ë ¥í–ˆë˜ í‚¤ì›Œë“œì¼ ê²½ìš° ìºì‹±ëœ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ë©° API í˜¸ì¶œì„ ë³´ë‚´ì§€ ì•ŠìŠµë‹ˆë‹¤. ë§Œì•½ ì‹œê°„ì´ ì§€ë‚˜ ìºì‹œëœ ë°ì´í„°ê°€ ì‚¬ë¼ì¡Œê±°ë‚˜, ì²˜ìŒ ê²€ìƒ‰í•˜ëŠ” í‚¤ì›Œë“œì¼ ê²½ìš° API í†µì‹ í›„ CacheStorageì— ìºì‹±í•©ë‹ˆë‹¤.

[CacheAPI ê³µì‹ë¬¸ì„œ](https://developer.mozilla.org/en-US/docs/Web/API/Cache)

### ë¸Œë¼ìš°ì €ì— ì €ì¥ëœ ìºì‹œë°ì´í„°

![image](https://user-images.githubusercontent.com/66008508/236444391-4e325512-880c-451e-a1d4-2267312079bf.png)

```typescript
// utils/isExpired
export const isExpired = (cachedAt: string | null) => {
  if (!cachedAt) return true;
  return new Date(cachedAt).getTime() + CSKeyword.EXPIRE_TIME < new Date().getTime();
};

// api/keyword
const BASE_URL = '/api/v1/search-conditions';

const needFetch = async (keyword: string) => {
  const url = `${BASE_URL}/?name=${keyword}`;
  const cache = await caches.open('keywords');
  const cachedData = await cache.match(url);

  if (!cachedData || isExpired(cachedData.headers.get('date'))) {
    return true;
  }
  return false;
};

const formatCache = async (cacheData: Response | undefined) => {
  return await cacheData?.json();
};

const fetchData = async (keyword: string) => {
  if (!keyword) return [];

  const url = `${BASE_URL}/?name=${keyword}`;
  const cache = await caches.open('keywords');

  if (await needFetch(keyword)) {
    //api í˜¸ì¶œ í›„ ì •ìƒ í˜¸ì¶œë˜ë©´ caching
    console.info('calling api');
    await cache.add(url);
  }

  const cachedData = await cache.match(url);
  return formatCache(cachedData);
};

const keywordApi = {
  fetchData,
};

export default keywordApi;
```

### LocalStorage vs CacheAPI

localStorageë¡œ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ìºì‹±í•˜ëŠ” ì „ëµì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ê³ ë ¤í–ˆìœ¼ë‚˜ ìºì‹±ë°ì´í„°ì˜ ìƒëª…ì£¼ê¸°ë¥¼ expiredTime ìœ¼ë¡œ ê´€ë¦¬í•´ì•¼ í–ˆìŠµë‹ˆë‹¤. expiredTimeì´ ì§€ë‚ ê²½ìš° ë°ì´í„°ë¥¼ ì‚­ì œ í•˜ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ì„  íŠ¹ì • ì‹œì ì—ì„œ localStorageë¥¼ íƒìƒ‰í•˜ê³ , ì œê±°í•´ì£¼ì–´ì•¼ í•˜ëŠ” ê¸°ëŠ¥ì´ í•„ìš”í–ˆìŠµë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê¸° ë³´ë‹¤ëŠ”, expiredTimeìœ¼ë¡œ ìºì‹œ ë°ì´í„°ë¥¼ ì˜ í™œìš©í•  ìˆ˜ ìˆëŠ” `CacheStorage`, `CacheAPI`ë¥¼ ì ìš©í–ˆìŠµë‹ˆë‹¤. `CacheAPI`ëŠ” urlìš”ì²­ì‹œ `fetch`ë¬¸ë²•ì„ ì‚¬ìš© í•´ì„œ API í†µì‹ ì„ ì‹œë„í•˜ê²Œ ë˜ëŠ”ë° ê¸°ì¡´ì˜ `axios`ì™€ëŠ” í˜¸í™˜ì´ ì•ˆë˜ëŠ”ë¬¸ì œê°€ ìˆì–´ ì „ì²´ í”„ë¡œì íŠ¸ì˜ APIí†µì‹  ë¶€ë¶„ì„ `axios` ì—ì„œ `fetch` ë¡œ ìˆ˜ì •í•˜ì—¬ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.
